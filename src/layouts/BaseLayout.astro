---
// Astro Imports - Components & Globas
import HeadSEO from "@/components/layout/HeadSEO.astro";
import Footer from "@/components/Footer.astro";
import Navbar from "@/components/Navbar.astro";
import { type CollectionEntry } from "astro:content";
import { getLangFromUrl } from "@/i18n/utils";
import "@/styles/globals.css";
import { ViewTransitions } from "astro:transitions";

// Props imterface
interface Props {
  title?: string | undefined
  description?: string | undefined
  ogImage?: URL | undefined
  url?: URL | undefined
  post?: CollectionEntry<'blog'>
}

// Astro Props
const { title, description, ogImage, url, post } = Astro.props

// Translation Imports

const lang = getLangFromUrl(Astro.url)
---

<html lang={lang} data-theme="dark">
  <head>
    <HeadSEO
      title={title}
      description={description}
      ogImage={ogImage}
      url={url}
      post={post}
    />
    <script is:inline>
      const setDarkMode = () => {
        const theme = (() => {
          if (
            typeof localStorage !== "undefined" &&
            localStorage.getItem("theme")
          ) {
            return localStorage.getItem("theme");
          }
          if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
            return "dark";
          }
          return "light";
        })();
      
        if (theme === "light") {
          document.documentElement.classList.remove("dark");
        } else {
          document.documentElement.classList.add("dark");
        }
        window.localStorage.setItem("theme", theme);
      };
      
      setDarkMode();
      document.addEventListener("astro:after-swap", setDarkMode);
      </script>
  </head>
  <body class="min-h-screen bg-background antialiased">
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe 
        src="https://www.googletagmanager.com/ns.html?id=GTM-T7CDGRPZ"
        height="0" 
        width="0" 
        style="display:none;visibility:hidden"></iframe></noscript
        >
    <!-- End Google Tag Manager (noscript) -->
    <div class="relative flex min-h-screen flex-col">
      <Navbar />
      <main class="flex-auto">
        <slot />
      </main>
      <Footer />
    </div>
  </body>
</html>

